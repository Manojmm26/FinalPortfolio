<div 
  #windowFrame
  cdkDrag
  cdkDragBoundary=".os-root"
  (cdkDragEnded)="onDragEnded($event)"
  [cdkDragDisabled]="process().isMaximized"
  class="window-frame absolute flex flex-col transition-all duration-200"
  [style.zIndex]="process().zIndex"
  [style.width.px]="process().isMaximized ? null : process().size.width"
  [style.height.px]="process().isMaximized ? null : process().size.height"
  [class.active]="isActive()"
  [class.shadow]="true"
  [style.boxShadow]="'var(--shadow)'"
  [style.borderRadius]="'var(--border-radius)'"
  [style.transition]="'transform 150ms ease-out, opacity 150ms ease-out'"
  [style.transform]="process().isMaximized ? 'translate(0, 0)' : 'translate(' + process().position.x + 'px, ' + process().position.y + 'px)'"
  [class.w-full]="process().isMaximized"
  [class.h-full]="process().isMaximized"
  [class.top-0]="process().isMaximized"
  [class.left-0]="process().isMaximized"
  [class.rounded-none]="process().isMaximized"
  (mousedown)="onFocus()">

  <div 
    cdkDragHandle
    class="title-bar flex items-center justify-between h-7 px-2 select-none cursor-default shrink-0"
    [style.color]="'var(--title-bar-text)'"
    [style.background]="isActive() ? 'var(--title-bar-bg)' : 'var(--title-bar-bg-inactive)'"
    [style.border-top-left-radius]="'var(--border-radius)'"
    [style.border-top-right-radius]="'var(--border-radius)'"
    (dblclick)="onMaximize()">
    <div class="flex items-center gap-2 truncate">
      <img [src]="process().icon" alt="icon" class="w-4 h-4" />
      <span class="title-text font-bold text-sm truncate">{{ process().title }}</span>
    </div>
    <div class="controls flex items-center gap-1" [style.background]="'var(--window-controls-bg)'">
        <button (click)="onMinimize()" class="win-button minimize">-</button>
        <button (click)="onMaximize()" class="win-button maximize">&#11036;</button>
        <button (click)="onClose()" class="win-button close">X</button>
    </div>
  </div>

  <div class="window-content flex-grow relative" [style.background]="'var(--window-content-bg)'">
     <ng-container [ngComponentOutlet]="process().component"></ng-container>
  </div>
</div>